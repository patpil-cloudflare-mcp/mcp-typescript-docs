/**
 * @wtyczki/mcp-security
 *
 * Security utilities for Cloudflare MCP servers
 * Provides output sanitization, PII redaction, and response validation
 *
 * @example
 * ```typescript
 * import { sanitizeOutput, redactPII } from '@wtyczki/mcp-security';
 *
 * const result = await tool.execute(params);
 * const sanitized = sanitizeOutput(result);
 * const { redacted } = redactPII(sanitized);
 * return { content: [{ type: "text", text: redacted }] };
 * ```
 */
export { sanitizeOutput } from './sanitization';
export { redactPII } from './pii-redaction';
export { validateOutput } from './validation';
/**
 * Version info for debugging and diagnostics
 */
export const VERSION = '1.1.0';
/**
 * Combined sanitization and PII redaction in one call
 * Recommended for most use cases
 *
 * @example
 * ```typescript
 * const { sanitized, redacted, detectedPII } = secureOutput(rawResult, {
 *   sanitize: { removeHtml: true },
 *   redact: { redactEmails: true, redactPhones: true }
 * });
 * ```
 */
export function secureOutput(text, options) {
    const { sanitizeOutput } = require('./sanitization');
    const { redactPII } = require('./pii-redaction');
    const sanitized = sanitizeOutput(text, options?.sanitize);
    const { redacted, detectedPII } = redactPII(sanitized, options?.redact);
    return { sanitized, redacted, detectedPII };
}
